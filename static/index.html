<html>

<head>
    <title>Test</title>
</head>

<body>
    <h1>test</h1>
    <div id="player"></div>
    <br>
    <input type="text" id="msg">
    <input type="button" id="submit" value="Go...">

    <script>
        var tag = document.createElement('script');

        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var player;
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '390',
                width: '640',
                videoId: 'M7lc1UVf-VE',
                playerVars: {
                    'playsinline': 1,
                    controls: 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            event.target.playVideo();
            socket.emit("playing")
        }

        function onPlayerStateChange(event) {
            switch (event.data) {
                case 0:
                    socket.emit("ended")
                    break;
                case 1:
                    socket.emit("playing")
                    break;
                case 2:
                    socket.emit("paused")
                    break;
                default:
                    break;
            }
            // console.log(event.target)
            // console.log(event)
        }
        function stopVideo() {
            player.stopVideo();
        }
    </script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        var socket = io();
        socket.on("playvideo", () => {
            player.playVideo()
        })
        socket.on("pausevideo", () => {
            player.pauseVideo()
        })
    </script>
</body>

</html>